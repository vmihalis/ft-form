# Milestone v2.1: AI Form Creation Assistant

**Status:** ✅ SHIPPED 2026-02-03
**Phases:** 25-28
**Total Plans:** 12

## Overview

Enable admins to create forms by describing what they need in natural language, with AI asking clarifying questions and generating complete form structures.

## Phases

### Phase 25: Core AI Infrastructure

**Goal:** Establish backend AI foundation with OpenRouter integration, streaming API, and Frontier Tower context
**Depends on:** Phase 24 (v2.0 complete)
**Plans:** 3 plans

Plans:
- [x] 25-01: Zod schemas mirroring FormSchema for AI output validation
- [x] 25-02: System prompt with FT context and error handling utilities
- [x] 25-03: Streaming API route with OpenRouter integration

**Details:**
- AI SDK v6 with React hooks and OpenRouter provider
- Streaming POST endpoint at /api/ai/generate
- Zod validation for AI-generated form schemas
- FT-CONTEXT.md embedded in system prompt
- User-friendly error transformation

### Phase 26: Chat UI & Conversation Flow

**Goal:** Build the conversational interface with hybrid structured/open questions and clear wizard states
**Depends on:** Phase 25
**Plans:** 3 plans

Plans:
- [x] 26-01: Wizard container, step indicator, form type and audience selection steps
- [x] 26-02: Chat interface with streaming, typing indicator, stop/retry functionality
- [x] 26-03: Page route, API key input, and end-to-end verification

**Details:**
- AIFormWizard with 4-step flow (form-type → audience → chat → preview)
- Form type selection (Application, Feedback, Registration, Survey, Other)
- Audience selection (External/Internal)
- Streaming chat with useChat hook
- API key entry with validation
- Human-verified E2E flow

### Phase 27: Form Generation & Preview

**Goal:** Generate valid form schemas using the 8 existing field types with accurate preview and iteration options
**Depends on:** Phase 26
**Plans:** 3 plans

Plans:
- [x] 27-01: Schema extraction utility for detecting and validating AI-generated schemas
- [x] 27-02: Form preview panel using DynamicField components
- [x] 27-03: Wizard integration with preview step and iteration flows

**Details:**
- extractFormSchema utility detects JSON in AI responses
- FormPreviewPanel renders schemas with existing form components
- Preview step with mobile/desktop toggle
- Regenerate and Modify Prompt iteration options
- Direct-to-draft toggle for confident users

### Phase 28: Integration & Polish

**Goal:** Complete the workflow from preview to created draft form with entry point integration and mobile support
**Depends on:** Phase 27
**Plans:** 3 plans

Plans:
- [x] 28-01: Backend (isSlugAvailable, createWithSchema) and NewFormDropdown entry point
- [x] 28-02: Dialog component and CreateFormModal with form creation flow
- [x] 28-03: Mobile responsiveness audit and fixes for AI wizard

**Details:**
- "Create with AI" in NewFormDropdown alongside "Create Manually"
- CreateFormModal with slug validation and draft creation
- Navigation options after creation (Edit in Builder, View All Forms)
- 44px touch targets, responsive layouts
- Chat height optimized for mobile keyboards

---

## Milestone Summary

**Key Decisions:**
- Use OpenRouter with user-provided API key (not built-in key)
- Hybrid questions: structured form type/audience selection + open prompt
- AI never modifies existing forms, always creates new drafts
- Model: anthropic/claude-sonnet-4 via OpenRouter
- API key in component state (not localStorage) for security
- Schema detection monitors status='ready' (stream complete before parsing)
- Direct-to-draft skips preview when enabled
- 44px touch targets on mobile, 40px on desktop

**Issues Resolved:**
- AI SDK v6 message parts extraction (use .parts array not .content string)
- Success state feedback when accepting form (added during Phase 27)

**Issues Deferred:**
None - all requirements completed

**Technical Debt Incurred:**
None - clean implementation

---

*For current project status, see .planning/ROADMAP.md*
