---
phase: 21-dashboard-hub-navigation
plan: 02
type: execute
wave: 2
depends_on: ["21-01"]
files_modified:
  - src/components/admin/Sidebar.tsx
  - src/components/admin/SidebarNav.tsx
  - src/app/admin/layout.tsx
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Sidebar expands to ~240px with labels visible"
    - "Sidebar collapses to ~64px with icons only"
    - "Clicking collapse toggle pins sidebar open/closed"
    - "Hovering over collapsed sidebar temporarily expands it"
    - "Active navigation item is visually highlighted"
  artifacts:
    - path: "src/components/admin/Sidebar.tsx"
      provides: "Collapsible sidebar with glass styling and animations"
      min_lines: 80
    - path: "src/components/admin/SidebarNav.tsx"
      provides: "Navigation items with icons and labels"
      exports: ["SidebarNav"]
  key_links:
    - from: "src/components/admin/Sidebar.tsx"
      to: "src/lib/stores/sidebar-store.ts"
      via: "useSidebarStore for collapse state"
      pattern: "useSidebarStore"
    - from: "src/app/admin/layout.tsx"
      to: "src/components/admin/Sidebar.tsx"
      via: "imports and renders Sidebar"
      pattern: "import.*Sidebar"
---

<objective>
Build the collapsible sidebar component with glass styling, smooth animations, and dual interaction (click to pin, hover to peek).

Purpose: The sidebar is the primary navigation for FrontierOS. It needs to feel premium with smooth animations, support both persistent (click) and transient (hover) expansion, and integrate with the design system's glassmorphism aesthetic.

Output: Fully functional collapsible sidebar with navigation items, integrated into admin layout.
</objective>

<execution_context>
@/home/memehalis/.claude/get-shit-done/workflows/execute-plan.md
@/home/memehalis/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/21-dashboard-hub-navigation/21-CONTEXT.md
@.planning/phases/21-dashboard-hub-navigation/21-RESEARCH.md
@.planning/phases/20-design-system-foundation/DESIGN-TOKENS.md
@src/lib/stores/sidebar-store.ts
@src/app/admin/layout.tsx
@src/app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Sidebar component with collapse/expand animations</name>
  <files>src/components/admin/Sidebar.tsx</files>
  <action>
Create the main Sidebar component with Motion animations and glass styling.

**Dimensions (from CONTEXT.md):**
- Expanded: ~240px width
- Collapsed: ~64px width

**Behavior (from CONTEXT.md):**
- Dual interaction: click to pin open, hover for quick peek when collapsed
- Default state: expanded (labels visible) for new users
- Collapse toggle button positioned at bottom of sidebar
- Glass panel with blur matching design system

**Implementation:**

```typescript
"use client";

import { motion } from "motion/react";
import { useSidebarStore } from "@/lib/stores/sidebar-store";
import { SidebarNav } from "./SidebarNav";
import { cn } from "@/lib/utils";
import { PanelLeft, PanelLeftClose } from "lucide-react";
import { Button } from "@/components/ui/button";

const sidebarVariants = {
  expanded: { width: 240 },
  collapsed: { width: 64 },
};

export function Sidebar() {
  const { isCollapsed, isHovering, setHovering, toggleCollapsed } = useSidebarStore();

  // Effective expansion state: pinned open OR hovering while collapsed
  const effectivelyExpanded = !isCollapsed || isHovering;

  return (
    <motion.aside
      initial={false}
      animate={effectivelyExpanded ? "expanded" : "collapsed"}
      variants={sidebarVariants}
      transition={{ duration: 0.2, ease: "easeInOut" }}
      onMouseEnter={() => isCollapsed && setHovering(true)}
      onMouseLeave={() => setHovering(false)}
      className={cn(
        "glass h-screen flex flex-col",
        "fixed left-0 top-0 z-40",
        "border-r border-glass-border"
      )}
    >
      {/* Logo/Brand area */}
      <div className="h-16 flex items-center px-4 border-b border-sidebar-border">
        {/* Logo placeholder - show icon when collapsed, full logo when expanded */}
      </div>

      {/* Navigation */}
      <nav className="flex-1 overflow-y-auto py-4">
        <SidebarNav isCollapsed={!effectivelyExpanded} />
      </nav>

      {/* Collapse toggle button at bottom */}
      <div className="p-3 border-t border-sidebar-border">
        <Button
          variant="ghost"
          size="icon"
          onClick={toggleCollapsed}
          className="w-full"
        >
          {isCollapsed ? (
            <PanelLeft className="h-5 w-5" />
          ) : (
            <PanelLeftClose className="h-5 w-5" />
          )}
        </Button>
      </div>
    </motion.aside>
  );
}
```

**Styling requirements:**
1. Use `glass` utility class from globals.css for glassmorphism
2. Fixed positioning on left side
3. Full viewport height
4. z-index: 40 (below modals at 50)
5. Border-right using sidebar border token
  </action>
  <verify>
```bash
# File exists and exports Sidebar
grep -q "export function Sidebar" src/components/admin/Sidebar.tsx && echo "Sidebar exported"
# Uses Motion for animation
grep -q "motion/react" src/components/admin/Sidebar.tsx && echo "Uses Motion"
# Uses sidebar store
grep -q "useSidebarStore" src/components/admin/Sidebar.tsx && echo "Uses store"
# Has glass styling
grep -q "glass" src/components/admin/Sidebar.tsx && echo "Has glass styling"
```
  </verify>
  <done>
- Sidebar component renders with glass styling
- Animates between 240px and 64px widths smoothly
- Toggle button at bottom works
- Hover-to-peek works when collapsed
- TypeScript compiles without errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Create SidebarNav with navigation items and integrate into layout</name>
  <files>src/components/admin/SidebarNav.tsx, src/app/admin/layout.tsx</files>
  <action>
Create the navigation items component and integrate the sidebar into the admin layout.

**SidebarNav.tsx:**

Navigation items with icons and labels, showing active state based on current route. Include optional `onNavigate` callback for closing mobile sheet (used in Plan 21-04).

```typescript
"use client";

import Link from "next/link";
import { usePathname } from "next/navigation";
import { motion } from "motion/react";
import { cn } from "@/lib/utils";
import { LucideIcon, LayoutDashboard, FileText, Users, Calendar, DoorOpen, Heart, LogOut } from "lucide-react";

interface NavItem {
  icon: LucideIcon;
  label: string;
  href: string;
  disabled?: boolean;
}

const navItems: NavItem[] = [
  { icon: LayoutDashboard, label: "Dashboard", href: "/admin" },
  { icon: FileText, label: "Forms", href: "/admin/forms" },
  { icon: Users, label: "Members", href: "/admin/members", disabled: true },
  { icon: Calendar, label: "Events", href: "/admin/events", disabled: true },
  { icon: DoorOpen, label: "Spaces", href: "/admin/spaces", disabled: true },
  { icon: Heart, label: "Wellness", href: "/admin/wellness", disabled: true },
];

interface SidebarNavProps {
  isCollapsed: boolean;
  onNavigate?: () => void;
}

export function SidebarNav({ isCollapsed, onNavigate }: SidebarNavProps) {
  const pathname = usePathname();

  return (
    <div className="space-y-1 px-3">
      {navItems.map((item) => {
        const isActive = item.href === "/admin"
          ? pathname === "/admin"
          : pathname.startsWith(item.href);

        return (
          <SidebarNavItem
            key={item.href}
            {...item}
            isCollapsed={isCollapsed}
            isActive={isActive}
            onNavigate={onNavigate}
          />
        );
      })}
    </div>
  );
}

interface SidebarNavItemProps extends NavItem {
  isCollapsed: boolean;
  isActive: boolean;
  onNavigate?: () => void;
}

function SidebarNavItem({
  icon: Icon,
  label,
  href,
  disabled,
  isCollapsed,
  isActive,
  onNavigate
}: SidebarNavItemProps) {
  const content = (
    <motion.div
      className={cn(
        "flex items-center gap-3 px-3 py-2 rounded-lg transition-colors",
        "hover:bg-sidebar-accent",
        isActive && "bg-sidebar-primary text-sidebar-primary-foreground",
        disabled && "opacity-50 cursor-not-allowed"
      )}
      whileHover={disabled ? undefined : { x: 4 }}
      transition={{ duration: 0.15 }}
    >
      <Icon className="h-5 w-5 shrink-0" />
      <motion.span
        initial={false}
        animate={{
          opacity: isCollapsed ? 0 : 1,
          width: isCollapsed ? 0 : "auto"
        }}
        transition={{ duration: 0.2 }}
        className="text-sm font-medium overflow-hidden whitespace-nowrap"
      >
        {label}
      </motion.span>
    </motion.div>
  );

  if (disabled) {
    return content;
  }

  return (
    <Link href={href} onClick={onNavigate}>
      {content}
    </Link>
  );
}
```

**Update admin layout:**

Integrate the Sidebar component. Set static margin for now - dynamic margin based on collapse state will be implemented in Plan 21-04.

Key changes:
1. Import and render Sidebar component
2. Add left margin to main content to avoid overlap (since sidebar is fixed)
3. Keep hidden below lg breakpoint for mobile

```tsx
// In layout.tsx
<div className="min-h-screen bg-background">
  <Sidebar /> {/* Fixed positioned */}
  <main className="lg:ml-[240px] min-h-screen">
    {children}
  </main>
</div>
```

**Note on dynamic margin:** The margin adjustment based on sidebar collapse state (`lg:ml-[240px]` vs `lg:ml-[64px]`) will be implemented in Plan 21-04 when the layout becomes a client component with access to useSidebarStore. This plan establishes the basic static margin at expanded width.
  </action>
  <verify>
```bash
# SidebarNav exists
grep -q "export function SidebarNav" src/components/admin/SidebarNav.tsx && echo "SidebarNav exported"
# SidebarNav has onNavigate prop
grep -q "onNavigate" src/components/admin/SidebarNav.tsx && echo "SidebarNav has onNavigate"
# Link has onClick handler
grep -q "onClick={onNavigate}" src/components/admin/SidebarNav.tsx && echo "Link has onClick handler"
# Layout imports Sidebar
grep -q "import.*Sidebar" src/app/admin/layout.tsx && echo "Layout imports Sidebar"
# Build succeeds
npm run build 2>&1 | tail -5
```
  </verify>
  <done>
- SidebarNav shows all navigation items with icons
- SidebarNav accepts onNavigate prop for callback on navigation
- Link components include onClick={onNavigate} handler
- Active route is highlighted
- Disabled items show muted styling
- Labels hide when collapsed, show when expanded
- Admin layout renders sidebar
- Main content area has static left margin of 240px on desktop
- Navigation between Dashboard and Forms works
  </done>
</task>

</tasks>

<verification>
```bash
# Build succeeds
npm run build

# Manual verification:
# 1. Visit /admin - sidebar should be visible and expanded
# 2. Click collapse button - sidebar should animate to 64px
# 3. Hover over collapsed sidebar - should expand temporarily
# 4. Click Dashboard nav item - should navigate to /admin
# 5. Click Forms nav item - should navigate to /admin/forms
# 6. Disabled items (Members, Events, etc.) should not navigate
```
</verification>

<success_criteria>
1. Sidebar renders with glass styling
2. Sidebar expands to ~240px, collapses to ~64px
3. Collapse toggle at bottom works
4. Hover-to-peek works when sidebar is collapsed
5. Navigation items show with icons and labels
6. SidebarNav has onNavigate prop with onClick handler on Link
7. Active route is visually highlighted
8. Disabled items are non-interactive
9. Build succeeds without errors
</success_criteria>

<output>
After completion, create `.planning/phases/21-dashboard-hub-navigation/21-02-SUMMARY.md`
</output>
