---
phase: 24-polish-ux
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui/empty-state.tsx
  - src/components/ui/error-state.tsx
  - src/components/form-builder/FormsList.tsx
  - src/components/admin/SubmissionsTable.tsx
autonomous: true

must_haves:
  truths:
    - "Empty states show helpful icon, message, and CTA"
    - "Error states clearly explain what went wrong with recovery action"
    - "Forms list uses reusable EmptyState component"
    - "Submissions table uses reusable EmptyState for no-results"
    - "Forms list shows ErrorState when loading fails"
    - "Submissions table shows ErrorState when loading fails"
  artifacts:
    - path: "src/components/ui/empty-state.tsx"
      provides: "Reusable EmptyState component"
      exports: ["EmptyState"]
    - path: "src/components/ui/error-state.tsx"
      provides: "Reusable ErrorState component"
      exports: ["ErrorState"]
    - path: "src/components/form-builder/FormsList.tsx"
      provides: "FormsList using EmptyState and ErrorState"
      contains: "EmptyState"
    - path: "src/components/admin/SubmissionsTable.tsx"
      provides: "SubmissionsTable using EmptyState and ErrorState"
      contains: "EmptyState"
  key_links:
    - from: "src/components/form-builder/FormsList.tsx"
      to: "src/components/ui/empty-state.tsx"
      via: "import EmptyState"
      pattern: "from.*empty-state"
    - from: "src/components/admin/SubmissionsTable.tsx"
      to: "src/components/ui/empty-state.tsx"
      via: "import EmptyState"
      pattern: "from.*empty-state"
    - from: "src/components/form-builder/FormsList.tsx"
      to: "src/components/ui/error-state.tsx"
      via: "import ErrorState"
      pattern: "from.*error-state"
    - from: "src/components/admin/SubmissionsTable.tsx"
      to: "src/components/ui/error-state.tsx"
      via: "import ErrorState"
      pattern: "from.*error-state"
---

<objective>
Create reusable EmptyState and ErrorState components and integrate them into existing views.

Purpose: UX-05 and UX-06 require helpful empty states and clear error states. Currently FormsListEmpty is inline. Creating reusable components ensures consistency and enables future views to easily add proper empty/error states.

Output: Reusable EmptyState and ErrorState components in ui/, integrated into FormsList and SubmissionsTable.
</objective>

<execution_context>
@/home/memehalis/.claude/get-shit-done/workflows/execute-plan.md
@/home/memehalis/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/24-polish-ux/24-RESEARCH.md

@src/components/form-builder/FormsList.tsx
@src/components/admin/SubmissionsTable.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create reusable EmptyState component</name>
  <files>src/components/ui/empty-state.tsx</files>
  <action>
    Create `src/components/ui/empty-state.tsx` with the following structure:

    ```tsx
    import * as React from "react";
    import Link from "next/link";
    import { type LucideIcon } from "lucide-react";
    import { cn } from "@/lib/utils";
    import { Button } from "@/components/ui/button";

    interface EmptyStateProps {
      icon?: LucideIcon;
      title: string;
      description: string;
      action?: {
        label: string;
        href?: string;
        onClick?: () => void;
      };
      className?: string;
    }

    function EmptyState({
      icon: Icon,
      title,
      description,
      action,
      className,
    }: EmptyStateProps) {
      return (
        <div className={cn("glass-card rounded-2xl p-12 text-center", className)}>
          {Icon && (
            <Icon
              className="h-12 w-12 mx-auto mb-4 text-muted-foreground"
              strokeWidth={1.5}
            />
          )}
          <h3 className="text-lg font-medium text-foreground mb-2">{title}</h3>
          <p className="text-muted-foreground mb-6 max-w-md mx-auto">
            {description}
          </p>
          {action && (
            action.href ? (
              <Button asChild>
                <Link href={action.href}>{action.label}</Link>
              </Button>
            ) : (
              <Button onClick={action.onClick}>{action.label}</Button>
            )
          )}
        </div>
      );
    }

    export { EmptyState, type EmptyStateProps };
    ```

    Key features:
    - Optional Lucide icon with thin stroke for elegance
    - Clear title and description
    - Optional action (can be link or button)
    - Uses glass-card for consistency with forms list
    - className prop for customization
  </action>
  <verify>File exists and exports EmptyState component with correct props interface</verify>
  <done>EmptyState component created with icon, title, description, and optional action support</done>
</task>

<task type="auto">
  <name>Task 2: Create reusable ErrorState component</name>
  <files>src/components/ui/error-state.tsx</files>
  <action>
    Create `src/components/ui/error-state.tsx` with the following structure:

    ```tsx
    import * as React from "react";
    import { AlertCircle } from "lucide-react";
    import { cn } from "@/lib/utils";
    import { Button } from "@/components/ui/button";

    interface ErrorStateProps {
      title?: string;
      message: string;
      action?: {
        label: string;
        onClick: () => void;
      };
      className?: string;
    }

    function ErrorState({
      title = "Something went wrong",
      message,
      action,
      className,
    }: ErrorStateProps) {
      return (
        <div
          className={cn(
            "glass-card rounded-2xl p-8 text-center border-destructive/20",
            className
          )}
        >
          <AlertCircle className="h-10 w-10 mx-auto mb-4 text-destructive" />
          <h3 className="text-lg font-medium text-foreground mb-2">{title}</h3>
          <p className="text-muted-foreground mb-6">{message}</p>
          {action && (
            <Button variant="outline" onClick={action.onClick}>
              {action.label}
            </Button>
          )}
        </div>
      );
    }

    export { ErrorState, type ErrorStateProps };
    ```

    Key features:
    - AlertCircle icon in destructive color
    - Default title with override option
    - Required message explaining what happened
    - Optional recovery action button
    - Destructive border accent for visual distinction
  </action>
  <verify>File exists and exports ErrorState component with correct props interface</verify>
  <done>ErrorState component created with title, message, and optional recovery action</done>
</task>

<task type="auto">
  <name>Task 3: Integrate EmptyState into FormsList and SubmissionsTable</name>
  <files>src/components/form-builder/FormsList.tsx, src/components/admin/SubmissionsTable.tsx</files>
  <action>
    **FormsList.tsx:**
    1. Import EmptyState: `import { EmptyState } from "@/components/ui/empty-state";`
    2. Import FileText icon: Add `FileText` to lucide-react imports
    3. Replace the inline FormsListEmpty function with EmptyState usage:

    Change the FormsListEmpty function to use EmptyState:
    ```tsx
    function FormsListEmpty() {
      return (
        <EmptyState
          icon={FileText}
          title="No forms yet"
          description="Create your first form to get started collecting submissions."
          action={{
            label: "Create Form",
            href: "/admin/forms/new",
          }}
        />
      );
    }
    ```

    **SubmissionsTable.tsx:**
    1. Import EmptyState: `import { EmptyState } from "@/components/ui/empty-state";`
    2. Import Inbox icon: Add `Inbox` to lucide-react imports (if not present, may need to add)
    3. Replace the inline "No submissions found" TableCell with EmptyState:

    Change the empty state in TableBody from:
    ```tsx
    <TableRow>
      <TableCell colSpan={submissionsColumns.length} className="h-24 text-center">
        No submissions found.
      </TableCell>
    </TableRow>
    ```

    To:
    ```tsx
    <TableRow>
      <TableCell colSpan={submissionsColumns.length} className="p-0">
        <EmptyState
          icon={Inbox}
          title="No submissions found"
          description="Try adjusting your filters or wait for new submissions to come in."
          className="rounded-none border-0 shadow-none bg-transparent"
        />
      </TableCell>
    </TableRow>
    ```

    Note: The className overrides make it fit naturally inside the table without extra glass styling.
  </action>
  <verify>
    - FormsList.tsx imports and uses EmptyState component
    - SubmissionsTable.tsx imports and uses EmptyState component
    - Both have appropriate icons and helpful descriptions
  </verify>
  <done>FormsList and SubmissionsTable use reusable EmptyState with icons and helpful guidance</done>
</task>

<task type="auto">
  <name>Task 4: Integrate ErrorState into FormsList and SubmissionsTable error handling</name>
  <files>src/components/form-builder/FormsList.tsx, src/components/admin/SubmissionsTable.tsx</files>
  <action>
    **FormsList.tsx:**
    1. Import ErrorState: `import { ErrorState } from "@/components/ui/error-state";`
    2. The FormsList component should have error handling for the fetch. Locate the error state handling (or add if missing).
    3. Replace any existing error display with ErrorState:

    ```tsx
    // If there's an error state variable or error from useSWR/useQuery
    if (error) {
      return (
        <ErrorState
          title="Failed to load forms"
          message="We couldn't retrieve your forms. Please try again."
          action={{
            label: "Retry",
            onClick: () => refetch(), // or mutate() for SWR
          }}
        />
      );
    }
    ```

    **SubmissionsTable.tsx:**
    1. Import ErrorState: `import { ErrorState } from "@/components/ui/error-state";`
    2. Locate error handling in the submissions loading logic.
    3. Replace any existing error display with ErrorState:

    ```tsx
    if (error) {
      return (
        <ErrorState
          title="Failed to load submissions"
          message="We couldn't retrieve the submissions for this form. Please try again."
          action={{
            label: "Retry",
            onClick: () => refetch(),
          }}
        />
      );
    }
    ```

    Note: Check the actual data fetching pattern used (SWR, React Query, or useState/useEffect) and use the appropriate refetch mechanism. If no explicit error handling exists, add an error state to the component.
  </action>
  <verify>
    - FormsList.tsx imports and uses ErrorState for error scenarios
    - SubmissionsTable.tsx imports and uses ErrorState for error scenarios
    - Both have retry actions that re-trigger the data fetch
  </verify>
  <done>FormsList and SubmissionsTable display helpful ErrorState with retry option when data loading fails</done>
</task>

</tasks>

<verification>
1. Both new component files exist in src/components/ui/
2. FormsList.tsx uses EmptyState instead of inline FormsListEmpty
3. SubmissionsTable.tsx uses EmptyState for empty rows
4. FormsList.tsx uses ErrorState for fetch failures
5. SubmissionsTable.tsx uses ErrorState for fetch failures
6. Run `npm run build` to verify no TypeScript errors
7. Visual test: View forms list with no forms - should show icon + helpful message
8. Visual test: View submissions with filters that return nothing - should show helpful empty state
9. Visual test: Simulate network error - should show ErrorState with retry button
</verification>

<success_criteria>
- EmptyState and ErrorState components created and exported
- FormsList and SubmissionsTable use EmptyState for empty data
- FormsList and SubmissionsTable use ErrorState for loading errors with retry actions
- Empty states have icons, helpful descriptions, and CTAs where appropriate
- UX-05 satisfied (empty states guide next action)
- UX-06 fully satisfied (ErrorState integrated into error scenarios with recovery actions)
- No build errors
</success_criteria>

<output>
After completion, create `.planning/phases/24-polish-ux/24-03-SUMMARY.md`
</output>
