---
phase: 01-foundation-data-layer
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tsconfig.json
  - tailwind.config.ts
  - next.config.ts
  - src/app/layout.tsx
  - src/app/page.tsx
  - src/app/globals.css
  - src/app/providers.tsx
  - convex/schema.ts
  - .env.local
autonomous: true

must_haves:
  truths:
    - "npm run dev starts Next.js development server without errors"
    - "Convex dev process syncs schema to cloud successfully"
    - "Applications table exists with all required fields and indexes"
  artifacts:
    - path: "package.json"
      provides: "Project dependencies"
      contains: "next"
    - path: "src/app/layout.tsx"
      provides: "Root layout with Convex provider"
      contains: "ConvexClientProvider"
    - path: "src/app/providers.tsx"
      provides: "Convex client setup"
      contains: "ConvexReactClient"
    - path: "convex/schema.ts"
      provides: "Database schema definition"
      contains: "applications"
  key_links:
    - from: "src/app/layout.tsx"
      to: "src/app/providers.tsx"
      via: "import ConvexClientProvider"
      pattern: "import.*ConvexClientProvider"
    - from: "src/app/providers.tsx"
      to: ".env.local"
      via: "NEXT_PUBLIC_CONVEX_URL"
      pattern: "NEXT_PUBLIC_CONVEX_URL"
---

<objective>
Create the Next.js 16 project with Convex backend integration and database schema.

Purpose: Establish the core technical foundation that all subsequent phases build upon. Without a working Next.js project and Convex schema, no other features can be implemented.

Output: Running Next.js 16 development server with Convex connected and applications schema deployed.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation-data-layer/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Scaffold Next.js 16 project with TypeScript and Tailwind</name>
  <files>
    package.json
    tsconfig.json
    tailwind.config.ts
    next.config.ts
    src/app/layout.tsx
    src/app/page.tsx
    src/app/globals.css
  </files>
  <action>
Create the Next.js 16 project in the current directory (ft-form already exists with .planning folder):

1. Run `npx create-next-app@16 . --typescript --tailwind --eslint --app --src-dir --import-alias="@/*" --turbopack --yes` to scaffold in current directory

2. Verify the scaffolding created:
   - `package.json` with next, react, typescript
   - `src/app/layout.tsx` root layout
   - `src/app/page.tsx` home page
   - `tailwind.config.ts` Tailwind configuration
   - `next.config.ts` Next.js configuration

3. Update `src/app/page.tsx` to redirect to /apply:
   ```typescript
   import { redirect } from "next/navigation";

   export default function Home() {
     redirect("/apply");
   }
   ```

Note: Use --yes flag to accept all defaults non-interactively. The project directory already has .planning folder which will be preserved.
  </action>
  <verify>
Run `npm run dev` - should start on localhost:3000 without errors. Visiting localhost:3000 will 404 (redirect to /apply which doesn't exist yet) - that's expected.
  </verify>
  <done>Next.js 16 project scaffolded with TypeScript, Tailwind CSS, App Router, and src directory structure</done>
</task>

<task type="auto">
  <name>Task 2: Install Convex and create applications schema with indexes</name>
  <files>
    package.json
    convex/schema.ts
    src/app/providers.tsx
    src/app/layout.tsx
    .env.local
  </files>
  <action>
1. Install Convex: `npm install convex`

2. Initialize Convex development environment: `npx convex dev --once`
   - This will prompt for Convex authentication (opens browser)
   - Creates new Convex project or links to existing
   - Generates `.env.local` with NEXT_PUBLIC_CONVEX_URL
   - Creates `convex/_generated/` directory

3. Create `convex/schema.ts` with the full applications schema:
   ```typescript
   import { defineSchema, defineTable } from "convex/server";
   import { v } from "convex/values";

   export default defineSchema({
     applications: defineTable({
       // Applicant Info
       fullName: v.string(),
       email: v.string(),
       linkedIn: v.optional(v.string()),
       role: v.string(),
       bio: v.string(),

       // Proposal
       floor: v.string(),
       floorOther: v.optional(v.string()),
       initiativeName: v.string(),
       tagline: v.string(),
       values: v.string(),
       targetCommunity: v.string(),
       estimatedSize: v.string(),

       // Roadmap
       phase1Mvp: v.string(),
       phase2Expansion: v.string(),
       phase3LongTerm: v.string(),

       // Impact
       benefitToFT: v.string(),

       // Logistics
       existingCommunity: v.string(),
       spaceNeeds: v.string(),
       startDate: v.string(),
       additionalNotes: v.optional(v.string()),

       // Meta
       status: v.union(
         v.literal("new"),
         v.literal("under_review"),
         v.literal("accepted"),
         v.literal("rejected")
       ),
       submittedAt: v.number(),
     })
       .index("by_status", ["status"])
       .index("by_floor", ["floor"])
       .index("by_email", ["email"])
       .index("by_submitted", ["submittedAt"]),
   });
   ```

4. Create `src/app/providers.tsx`:
   ```typescript
   "use client";
   import { ConvexProvider, ConvexReactClient } from "convex/react";
   import { ReactNode } from "react";

   const convex = new ConvexReactClient(process.env.NEXT_PUBLIC_CONVEX_URL!);

   export function ConvexClientProvider({ children }: { children: ReactNode }) {
     return <ConvexProvider client={convex}>{children}</ConvexProvider>;
   }
   ```

5. Update `src/app/layout.tsx` to wrap with ConvexClientProvider:
   - Import ConvexClientProvider from "./providers"
   - Wrap {children} with <ConvexClientProvider>

6. Push schema to Convex: `npx convex dev --once`
   - This syncs the schema to Convex cloud
   - Regenerates types in convex/_generated/

IMPORTANT: The ConvexReactClient must be created OUTSIDE the component function (module scope) to prevent WebSocket reconnection on re-renders.
  </action>
  <verify>
1. Run `npx convex dev --once` - should complete without schema errors
2. Visit Convex dashboard (URL shown in terminal) - applications table should exist with all fields
3. Run `npm run dev` - should start without Convex-related errors
  </verify>
  <done>Convex installed and configured with applications schema containing all required fields (applicant info, proposal, roadmap, impact, logistics, meta) and indexes (by_status, by_floor, by_email, by_submitted)</done>
</task>

</tasks>

<verification>
After both tasks complete:
1. `npm run dev` starts without errors
2. `npx convex dev --once` shows schema synced successfully
3. Convex dashboard shows applications table with:
   - All 20 fields defined
   - 4 indexes (by_status, by_floor, by_email, by_submitted)
4. `.env.local` contains NEXT_PUBLIC_CONVEX_URL
</verification>

<success_criteria>
- Next.js 16 development server runs on localhost:3000
- Convex schema deployed with applications table
- ConvexClientProvider wraps the application
- TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-data-layer/01-01-SUMMARY.md`
</output>
