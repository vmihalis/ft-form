---
phase: 23-forms-submissions-redesign
plan: 02
type: execute
wave: 2
depends_on: ["23-01"]
files_modified:
  - src/components/form-builder/FormsGrid.tsx
  - src/components/form-builder/FormsList.tsx
autonomous: true

must_haves:
  truths:
    - "Forms display in a responsive grid layout"
    - "Cards animate in with staggered entrance animation"
    - "Cards animate out smoothly when filtered or removed"
    - "Empty state displays when no forms exist"
  artifacts:
    - path: "src/components/form-builder/FormsGrid.tsx"
      provides: "Grid container with stagger animations"
      contains: "staggerChildren"
    - path: "src/components/form-builder/FormsList.tsx"
      provides: "Updated forms list using grid layout"
      contains: "FormsGrid"
  key_links:
    - from: "src/components/form-builder/FormsList.tsx"
      to: "FormsGrid.tsx"
      via: "Renders FormsGrid with forms data"
      pattern: "<FormsGrid"
    - from: "src/components/form-builder/FormsGrid.tsx"
      to: "FormCard.tsx"
      via: "Renders FormCard for each form"
      pattern: "<FormCard"
---

<objective>
Create FormsGrid component with staggered animations and update FormsList to use the new card-based layout.

Purpose: Complete the forms list visual transformation with AnimatePresence-powered transitions (FORM-01, FORM-04).

Output: FormsGrid component with stagger animation, updated FormsList component using grid layout instead of table.
</objective>

<execution_context>
@/home/memehalis/.claude/get-shit-done/workflows/execute-plan.md
@/home/memehalis/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/23-forms-submissions-redesign/23-RESEARCH.md

# Key files
@src/components/form-builder/FormsList.tsx
@src/components/form-builder/FormCard.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create FormsGrid component with stagger animations</name>
  <files>src/components/form-builder/FormsGrid.tsx</files>
  <action>
Create a new FormsGrid component that wraps form cards with staggered enter/exit animations.

Create `src/components/form-builder/FormsGrid.tsx`:

```typescript
"use client";

import { motion, AnimatePresence } from "motion/react";
import { FormCard } from "./FormCard";
import { Id } from "@/../convex/_generated/dataModel";

const containerVariants = {
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: {
      staggerChildren: 0.05,
    },
  },
};

const itemVariants = {
  hidden: { opacity: 0, y: 20 },
  visible: {
    opacity: 1,
    y: 0,
    transition: {
      duration: 0.3,
    },
  },
  exit: {
    opacity: 0,
    scale: 0.95,
    transition: {
      duration: 0.2,
    },
  },
};

interface FormData {
  _id: Id<"forms">;
  name: string;
  slug: string;
  status: "draft" | "published" | "archived";
  submissionCount: number;
  updatedAt: number;
}

interface FormsGridProps {
  forms: FormData[];
  onDuplicate: (formId: Id<"forms">) => void;
}

export function FormsGrid({ forms, onDuplicate }: FormsGridProps) {
  return (
    <motion.div
      className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
      variants={containerVariants}
      initial="hidden"
      animate="visible"
    >
      <AnimatePresence mode="popLayout">
        {forms.map((form) => (
          <motion.div
            key={form._id}
            variants={itemVariants}
            layout
            exit="exit"
          >
            <FormCard form={form} onDuplicate={() => onDuplicate(form._id)} />
          </motion.div>
        ))}
      </AnimatePresence>
    </motion.div>
  );
}
```

Key implementation details:
- `staggerChildren: 0.05` creates 50ms delay between each card appearing
- `mode="popLayout"` ensures smooth layout transitions when items are removed
- `layout` prop on motion.div enables smooth repositioning
- Exit animation is faster (0.2s) than enter (0.3s) for snappy feel
  </action>
  <verify>TypeScript compiles without errors: `npx tsc --noEmit`</verify>
  <done>FormsGrid component exists with staggered entrance and exit animations</done>
</task>

<task type="auto">
  <name>Task 2: Update FormsList to use FormsGrid</name>
  <files>src/components/form-builder/FormsList.tsx</files>
  <action>
Refactor FormsList to use the new FormsGrid component instead of the table layout.

Replace the current table-based implementation with the card grid. Preserve the existing functionality:
- Loading skeleton (update to grid skeleton)
- Empty state
- Duplicate handling
- Create button

Updated `src/components/form-builder/FormsList.tsx`:

```typescript
"use client";

import { useState } from "react";
import Link from "next/link";
import { useRouter } from "next/navigation";
import { useQuery, useMutation } from "convex/react";
import { api } from "@/../convex/_generated/api";
import { Id } from "@/../convex/_generated/dataModel";
import { Button } from "@/components/ui/button";
import { Skeleton } from "@/components/ui/skeleton";
import { Plus } from "lucide-react";
import { FormsGrid } from "./FormsGrid";

/**
 * Loading skeleton for forms grid
 */
function FormsGridSkeleton() {
  return (
    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {Array.from({ length: 6 }).map((_, i) => (
        <div key={i} className="glass-card rounded-2xl p-6 min-h-[180px] flex flex-col">
          <div className="flex items-start justify-between mb-4">
            <Skeleton className="h-6 w-20 rounded-full" />
            <Skeleton className="h-8 w-8 rounded" />
          </div>
          <Skeleton className="h-6 w-3/4 mb-2" />
          <Skeleton className="h-4 w-1/2" />
          <div className="flex-1" />
          <div className="flex items-center justify-between mt-4 pt-4 border-t border-border">
            <Skeleton className="h-4 w-24" />
            <Skeleton className="h-4 w-20" />
          </div>
        </div>
      ))}
    </div>
  );
}

/**
 * Empty state when no forms exist
 */
function FormsListEmpty() {
  return (
    <div className="glass-card rounded-2xl p-12 text-center">
      <h3 className="text-lg font-medium text-foreground mb-2">No forms yet</h3>
      <p className="text-muted-foreground mb-6">
        Create your first form to get started collecting submissions.
      </p>
      <Button asChild>
        <Link href="/admin/forms/new">
          <Plus className="h-4 w-4 mr-2" />
          Create Form
        </Link>
      </Button>
    </div>
  );
}

/**
 * Forms list component using glassmorphism card grid
 *
 * Displays all forms with status, submission count, and last updated.
 * Each card links to the form editor with quick actions dropdown.
 */
export function FormsList() {
  const router = useRouter();
  const forms = useQuery(api.forms.list);
  const duplicate = useMutation(api.forms.duplicate);

  const [duplicatingId, setDuplicatingId] = useState<Id<"forms"> | null>(null);

  // Handle form duplication
  const handleDuplicate = async (formId: Id<"forms">) => {
    setDuplicatingId(formId);
    try {
      const newFormId = await duplicate({ formId });
      router.push(`/admin/forms/${newFormId}`);
    } catch (error) {
      console.error("Failed to duplicate form:", error);
      setDuplicatingId(null);
    }
  };

  // Loading state
  if (forms === undefined) {
    return (
      <div className="space-y-6">
        <div className="flex justify-between items-center">
          <div />
          <Button asChild>
            <Link href="/admin/forms/new">
              <Plus className="h-4 w-4 mr-2" />
              Create Form
            </Link>
          </Button>
        </div>
        <FormsGridSkeleton />
      </div>
    );
  }

  // Empty state
  if (forms.length === 0) {
    return <FormsListEmpty />;
  }

  return (
    <div className="space-y-6">
      {/* Header with create button */}
      <div className="flex justify-between items-center">
        <p className="text-muted-foreground">
          {forms.length} {forms.length === 1 ? "form" : "forms"}
        </p>
        <Button asChild>
          <Link href="/admin/forms/new">
            <Plus className="h-4 w-4 mr-2" />
            Create Form
          </Link>
        </Button>
      </div>

      {/* Forms grid */}
      <FormsGrid forms={forms} onDuplicate={handleDuplicate} />
    </div>
  );
}
```

Key changes from original:
- Replace Table components with FormsGrid
- Update skeleton to match card layout
- Preserve duplicate functionality
- Remove individual row action buttons (now in FormCard dropdown)
- Remove delete functionality from this level (keep archive only)
- Add count display in header
  </action>
  <verify>
1. `npx tsc --noEmit` passes
2. Run dev server `npm run dev` and navigate to /admin/forms
3. Verify cards display in grid layout
4. Verify cards animate on initial load
  </verify>
  <done>FormsList uses FormsGrid with card layout and animated transitions</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with no type errors
2. Forms page (/admin/forms) displays cards in 1/2/3 column grid (responsive)
3. Cards animate in with staggered effect on page load
4. Clicking card navigates to form editor
5. Quick actions dropdown works (edit, duplicate, archive)
6. Empty state shows when no forms exist
7. Loading skeleton shows grid layout
</verification>

<success_criteria>
- Forms display in responsive grid with glassmorphism cards (FORM-01 complete)
- Cards animate in with stagger effect (FORM-04 partial)
- All existing functionality preserved (create, duplicate, navigate)
</success_criteria>

<output>
After completion, create `.planning/phases/23-forms-submissions-redesign/23-02-SUMMARY.md`
</output>
