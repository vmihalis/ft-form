---
phase: 06-admin-dashboard
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - package-lock.json
  - src/components/ui/table.tsx
  - src/components/ui/sheet.tsx
  - src/components/ui/badge.tsx
  - src/components/ui/dropdown-menu.tsx
  - convex/applications.ts
autonomous: true

must_haves:
  truths:
    - "TanStack Table is installed and importable"
    - "shadcn table, sheet, badge, dropdown-menu components exist"
    - "Convex list query returns all applications ordered by date desc"
    - "Convex updateStatus mutation changes application status"
  artifacts:
    - path: "src/components/ui/table.tsx"
      provides: "Table UI primitives"
      min_lines: 50
    - path: "src/components/ui/sheet.tsx"
      provides: "Sheet/panel component"
      min_lines: 50
    - path: "src/components/ui/badge.tsx"
      provides: "Badge component for status"
      min_lines: 20
    - path: "src/components/ui/dropdown-menu.tsx"
      provides: "Dropdown menu component"
      min_lines: 100
    - path: "convex/applications.ts"
      provides: "list query and updateStatus mutation"
      exports: ["submit", "list", "updateStatus"]
  key_links:
    - from: "convex/applications.ts"
      to: "convex/schema.ts"
      via: "applications table"
      pattern: 'query\\("applications"\\)'
---

<objective>
Install TanStack Table, add shadcn components, and create Convex backend functions for the admin dashboard.

Purpose: Establish the foundation for the applications table - dependencies, UI primitives, and data layer.
Output: All packages installed, shadcn components added, Convex list/updateStatus functions working.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-admin-dashboard/06-RESEARCH.md

@convex/schema.ts
@convex/applications.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install TanStack Table and shadcn components</name>
  <files>
    package.json
    package-lock.json
    src/components/ui/table.tsx
    src/components/ui/sheet.tsx
    src/components/ui/badge.tsx
    src/components/ui/dropdown-menu.tsx
  </files>
  <action>
    1. Install TanStack Table:
       npm install @tanstack/react-table

    2. Add shadcn components (one command):
       npx shadcn@latest add table sheet badge dropdown-menu --yes

    This adds the four components needed for the admin dashboard.
  </action>
  <verify>
    - npm ls @tanstack/react-table shows package installed
    - All four component files exist in src/components/ui/
  </verify>
  <done>
    TanStack Table installed, shadcn table/sheet/badge/dropdown-menu components added.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add Convex list query and updateStatus mutation</name>
  <files>convex/applications.ts</files>
  <action>
    Update convex/applications.ts to add:

    1. A `list` query that:
       - Returns all applications
       - Uses the by_submitted index
       - Orders by submittedAt desc (newest first)
       - Returns the full document (all fields)

    2. An `updateStatus` mutation that:
       - Takes id (v.id("applications")) and status (union of 4 literals)
       - Patches the application with new status
       - Returns nothing (void)

    Import `query` from "./_generated/server" in addition to existing `mutation`.

    Pattern from research:
    ```typescript
    export const list = query({
      args: {},
      handler: async (ctx) => {
        return await ctx.db
          .query("applications")
          .withIndex("by_submitted")
          .order("desc")
          .collect();
      },
    });

    export const updateStatus = mutation({
      args: {
        id: v.id("applications"),
        status: v.union(
          v.literal("new"),
          v.literal("under_review"),
          v.literal("accepted"),
          v.literal("rejected")
        ),
      },
      handler: async (ctx, args) => {
        await ctx.db.patch(args.id, { status: args.status });
      },
    });
    ```
  </action>
  <verify>
    - Run `npx convex dev` and confirm no errors (or check existing dev server logs)
    - Convex type generation completes (api.applications.list and api.applications.updateStatus exist in generated types)
  </verify>
  <done>
    Convex applications.ts exports submit, list, and updateStatus functions.
  </done>
</task>

</tasks>

<verification>
1. `npm ls @tanstack/react-table` shows ^8.x installed
2. `ls src/components/ui/` includes table.tsx, sheet.tsx, badge.tsx, dropdown-menu.tsx
3. `grep "export const list" convex/applications.ts` returns match
4. `grep "export const updateStatus" convex/applications.ts` returns match
5. TypeScript compiles without errors: `npx tsc --noEmit`
</verification>

<success_criteria>
- TanStack Table package installed
- Four shadcn components added (table, sheet, badge, dropdown-menu)
- Convex list query returns applications ordered by date desc
- Convex updateStatus mutation patches application status
- No TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/06-admin-dashboard/06-01-SUMMARY.md`
</output>
